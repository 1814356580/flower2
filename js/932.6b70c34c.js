"use strict";(self["webpackChunkflower_shop"]=self["webpackChunkflower_shop"]||[]).push([[932],{9093:function(t,i,e){e.d(i,{Z:function(){return u}});var s=function(){var t=this,i=t._self._c;return i("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(i){t.show=i},expression:"show"}},[i("van-picker",{ref:"picker",attrs:{title:"标题","show-toolbar":"",columns:t.columns,"value-key":t.valueKey},on:{confirm:t.onConfirm,cancel:t.onCancel}})],1)},a=[],o=(e(1958),e(2939),e(1744),e(7722)),n=(e(836),e(6811)),r={name:"pickerPopup",components:{[n.Z.name]:n.Z,[o.Z.name]:o.Z},data(){return{show:!1,columns:[]}},props:{datas:{type:Array,default:()=>[]},valueKey:{type:String,default:"text"}},methods:{setList(t){this.columns=t},showPopup(t){this.show=!this.show,t&&this.$nextTick((i=>{this.$refs.picker.setIndexes(t)}))},onConfirm(t,i){this.show=!1,this.$emit("confirm",t,i)},onCancel(){this.show=!1}},mounted(){},watch:{datas(){this.datas.length>0&&(this.columns=this.datas)}}},l=r,c=e(1001),h=(0,c.Z)(l,s,a,!1,null,"7de9f24c",null),u=h.exports},9602:function(t,i,e){e.r(i),e.d(i,{default:function(){return st}});var s=function(){var t=this,i=t._self._c;return i("div",{staticClass:"root"},[i("action-bar",{attrs:{title:"编辑商品"}}),i("div",{staticClass:"container"},[i("scroll-view",{staticClass:"content",attrs:{data:t.goodsData}},[i("div",{staticClass:"top"}),i("div",{staticClass:"box"},[i("div",{staticClass:"box-img"},t._l(t.goodsImgs,(function(s,a){return i("div",{key:s.url},[i("div",{staticClass:"box-img-item"},["add"!==s.type?i("van-image",{class:["goods-size","add"!=s.type?"goods-default-img":""],attrs:{radius:".25rem",src:t.getImgUrl(s.url)},on:{click:function(i){return t.imgClick(s.type,s.url)}}}):t._e(),"add"===s.type?i("van-uploader",{attrs:{"after-read":t.afterRead}},[i("img",{class:["goods-size","add"!=s.type?"goods-default-img":""],attrs:{src:e(6830)},on:{click:function(i){return t.imgClick(s.type,s.url)}}})]):t._e(),"custom"===s.type?i("img",{staticClass:"img-delete",attrs:{src:e(1757)},on:{click:function(i){return t.bindDelete(a)}}}):t._e(),"default"===s.type?i("div",{staticClass:"default-img"},[t._v("默认图片")]):"add"===s.type?i("div"):"custom"===s.type&&!0===s.headImg?i("div",{staticClass:"head-img"},[t._v("头图 ")]):"custom"===s.type&&!1===s.headImg?i("div",{staticClass:"set-head-img",on:{click:function(i){return t.bindHeadImg(a)}}},[t._v("设为头图")]):t._e()],1)])})),0),i("div",{staticClass:"img-tips"},[t._v("*图片操作无需保存")])]),i("div",{staticClass:"box"},[i("div",[t._v(t._s(t.goodsData.categoryName))]),i("div",{staticClass:"goods-classify"},[i("div",[t._v("分类:"),i("span",{staticClass:"classify-content"},[t._v(t._s(t.goodsData.sortName))])]),i("div",[t._v("颜色:"),i("span",{staticClass:"classify-content"},[t._v(t._s(t.goodsData.color))])]),i("div",[t._v("等级:"),i("span",{staticClass:"classify-content"},[t._v(t._s(t.goodsData.level))])]),i("div",[t._v("规格:"),i("span",{staticClass:"classify-content"},[t._v(t._s(t.goodsData.specificationName))])])])]),i("div",{staticClass:"box"},[i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("长度（cm）")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.goodsData.length,expression:"goodsData.length"}],staticClass:"attribute-right",attrs:{maxlength:"12",type:"Number",placeholder:"输入长度"},domProps:{value:t.goodsData.length},on:{input:function(i){i.target.composing||t.$set(t.goodsData,"length",i.target.value)}}})]),i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("宽度（cm）")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.goodsData.width,expression:"goodsData.width"}],staticClass:"attribute-right",attrs:{maxlength:"12",type:"Number",placeholder:"输入宽度"},domProps:{value:t.goodsData.width},on:{input:function(i){i.target.composing||t.$set(t.goodsData,"width",i.target.value)}}})]),i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("高度（cm）")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.goodsData.height,expression:"goodsData.height"}],staticClass:"attribute-right",attrs:{maxlength:"12",type:"Number",placeholder:"输入高度"},domProps:{value:t.goodsData.height},on:{input:function(i){i.target.composing||t.$set(t.goodsData,"height",i.target.value)}}})]),i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("成熟度")]),i("div",{staticClass:"attribute-picker-right"},[i("div",{staticClass:"attribute-picker-view",on:{click:t.bindPickerRawOpeningName}},[i("input",{staticClass:"attribute-input",attrs:{type:"text",disabled:"",placeholder:"请选择开放度"},domProps:{value:t.goodsData.rawOpeningName}}),i("span",{staticClass:"triangle"})])])]),i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("产地")]),i("div",{staticClass:"attribute-picker-right",on:{click:t.bindPickerOriginName}},[i("div",{staticClass:"attribute-picker-view"},[i("input",{staticClass:"attribute-input",attrs:{type:"text",disabled:"",placeholder:"请选择产地"},domProps:{value:t.goodsData.originName}}),i("span",{staticClass:"triangle"})])])]),i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("花头大小")]),i("div",{staticClass:"attribute-picker-right"},[i("div",{staticClass:"attribute-picker-view",on:{click:t.bindPickerflowerHeadStateName}},[i("input",{staticClass:"attribute-input",attrs:{type:"text",disabled:"",placeholder:"请选择花头大小"},domProps:{value:t.goodsData.flowerHeadStateName}}),i("span",{staticClass:"triangle"})])])]),i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("优点")]),i("div",{staticClass:"attribute-picker-right"},[i("div",{staticClass:"attribute-picker-view",on:{click:t.bindPickerMerit}},[i("input",{staticClass:"attribute-input",attrs:{type:"text",disabled:""},domProps:{value:t.goodsData.merit}}),i("span",{staticClass:"triangle"})])])]),i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("缺点")]),i("div",{staticClass:"attribute-picker-right"},[i("div",{staticClass:"attribute-picker-view",on:{click:t.bindPickerDefect}},[i("input",{staticClass:"attribute-input",attrs:{type:"text",disabled:""},domProps:{value:t.goodsData.defect}}),i("span",{staticClass:"triangle"})])])]),i("div",{staticClass:"attribute"},[i("div",{staticClass:"attribute-left"},[t._v("备注")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.goodsData.productRemark,expression:"goodsData.productRemark"}],staticClass:"textarea-right",attrs:{maxlength:"75",placeholder:"输入备注"},domProps:{value:t.goodsData.productRemark},on:{input:function(i){i.target.composing||t.$set(t.goodsData,"productRemark",i.target.value)}}})])])])],1),i("div",{staticClass:"bottom"},[i("div",{staticClass:"button-normal submit",on:{click:t.handleSubmit}},[t._v("保存")])]),i("picker-popup",{ref:"rawOpeningPopup",attrs:{valueKey:"displayName",datas:t.ruleData.rawOpening?t.ruleData.rawOpening.list:[]},on:{confirm:t.rawOpeningPopup}}),i("picker-popup",{ref:"originPopup",attrs:{valueKey:"displayName",datas:t.ruleData.origin?t.ruleData.origin.list:[]},on:{confirm:t.originPopup}}),i("picker-popup",{ref:"flowerPopup",attrs:{valueKey:"displayName",datas:t.ruleData.flowerHeadState?t.ruleData.flowerHeadState.list:[]},on:{confirm:t.flowerPopup}}),i("picker-popup",{ref:"originPopup",attrs:{valueKey:"displayName",datas:t.ruleData.origin?t.ruleData.origin.list:[]},on:{confirm:t.originPopup}}),i("picker-popup",{ref:"meritPopup",attrs:{valueKey:"displayName",datas:t.ruleData.merit?t.ruleData.merit.list:[]},on:{confirm:t.meritPopup}}),i("picker-popup",{ref:"defectPopup",attrs:{valueKey:"displayName",datas:t.ruleData.defect?t.ruleData.defect.list:[]},on:{confirm:t.defectPopup}})],1)},a=[],o=(e(1958),e(6196),e(3332),e(6742),e(7179),e(2666),e(2939),e(9299)),n=e(6369),r=e(855),l=(0,r.d)("image-preview"),c=l[0],h=l[1],u=e(7846),d=e(3969),p=e(5590),m=e(9858),g=e(4292),v=e(5781),f=e(7799),w=e(4535),b=e(9435),y=(0,r.d)("swipe"),A=y[0],C=y[1],D=A({mixins:[d.D,(0,b.G)("vanSwipe"),(0,p.X)((function(t,i){t(window,"resize",this.resize,!0),t(window,"orientationchange",this.resize,!0),t(window,"visibilitychange",this.onVisibilityChange),i?this.initialize():this.clear()}))],props:{width:[Number,String],height:[Number,String],autoplay:[Number,String],vertical:Boolean,lazyRender:Boolean,indicatorColor:String,loop:{type:Boolean,default:!0},duration:{type:[Number,String],default:500},touchable:{type:Boolean,default:!0},initialSwipe:{type:[Number,String],default:0},showIndicators:{type:Boolean,default:!0},stopPropagation:{type:Boolean,default:!0}},data:function(){return{rect:null,offset:0,active:0,deltaX:0,deltaY:0,swiping:!1,computedWidth:0,computedHeight:0}},watch:{children:function(){this.initialize()},initialSwipe:function(){this.initialize()},autoplay:function(t){t>0?this.autoPlay():this.clear()}},computed:{count:function(){return this.children.length},maxCount:function(){return Math.ceil(Math.abs(this.minOffset)/this.size)},delta:function(){return this.vertical?this.deltaY:this.deltaX},size:function(){return this[this.vertical?"computedHeight":"computedWidth"]},trackSize:function(){return this.count*this.size},activeIndicator:function(){return(this.active+this.count)%this.count},isCorrectDirection:function(){var t=this.vertical?"vertical":"horizontal";return this.direction===t},trackStyle:function(){var t={transitionDuration:(this.swiping?0:this.duration)+"ms",transform:"translate"+(this.vertical?"Y":"X")+"("+this.offset+"px)"};if(this.size){var i=this.vertical?"height":"width",e=this.vertical?"width":"height";t[i]=this.trackSize+"px",t[e]=this[e]?this[e]+"px":""}return t},indicatorStyle:function(){return{backgroundColor:this.indicatorColor}},minOffset:function(){return(this.vertical?this.rect.height:this.rect.width)-this.size*this.count}},mounted:function(){this.bindTouchEvent(this.$refs.track)},methods:{initialize:function(t){if(void 0===t&&(t=+this.initialSwipe),this.$el&&!(0,g.x)(this.$el)){clearTimeout(this.timer);var i={width:this.$el.offsetWidth,height:this.$el.offsetHeight};this.rect=i,this.swiping=!0,this.active=t,this.computedWidth=+this.width||i.width,this.computedHeight=+this.height||i.height,this.offset=this.getTargetOffset(t),this.children.forEach((function(t){t.offset=0})),this.autoPlay()}},resize:function(){this.initialize(this.activeIndicator)},onVisibilityChange:function(){document.hidden?this.clear():this.autoPlay()},onTouchStart:function(t){this.touchable&&(this.clear(),this.touchStartTime=Date.now(),this.touchStart(t),this.correctPosition())},onTouchMove:function(t){this.touchable&&this.swiping&&(this.touchMove(t),this.isCorrectDirection&&((0,v.PF)(t,this.stopPropagation),this.move({offset:this.delta})))},onTouchEnd:function(){if(this.touchable&&this.swiping){var t=this.size,i=this.delta,e=Date.now()-this.touchStartTime,s=i/e,a=Math.abs(s)>.25||Math.abs(i)>t/2;if(a&&this.isCorrectDirection){var o=this.vertical?this.offsetY:this.offsetX,n=0;n=this.loop?o>0?i>0?-1:1:0:-Math[i>0?"ceil":"floor"](i/t),this.move({pace:n,emitChange:!0})}else i&&this.move({pace:0});this.swiping=!1,this.autoPlay()}},getTargetActive:function(t){var i=this.active,e=this.count,s=this.maxCount;return t?this.loop?(0,w.w6)(i+t,-1,e):(0,w.w6)(i+t,0,s):i},getTargetOffset:function(t,i){void 0===i&&(i=0);var e=t*this.size;this.loop||(e=Math.min(e,-this.minOffset));var s=i-e;return this.loop||(s=(0,w.w6)(s,this.minOffset,0)),s},move:function(t){var i=t.pace,e=void 0===i?0:i,s=t.offset,a=void 0===s?0:s,o=t.emitChange,n=this.loop,r=this.count,l=this.active,c=this.children,h=this.trackSize,u=this.minOffset;if(!(r<=1)){var d=this.getTargetActive(e),p=this.getTargetOffset(d,a);if(n){if(c[0]&&p!==u){var m=p<u;c[0].offset=m?h:0}if(c[r-1]&&0!==p){var g=p>0;c[r-1].offset=g?-h:0}}this.active=d,this.offset=p,o&&d!==l&&this.$emit("change",this.activeIndicator)}},prev:function(){var t=this;this.correctPosition(),this.resetTouchStatus(),(0,f.d1)((function(){t.swiping=!1,t.move({pace:-1,emitChange:!0})}))},next:function(){var t=this;this.correctPosition(),this.resetTouchStatus(),(0,f.d1)((function(){t.swiping=!1,t.move({pace:1,emitChange:!0})}))},swipeTo:function(t,i){var e=this;void 0===i&&(i={}),this.correctPosition(),this.resetTouchStatus(),(0,f.d1)((function(){var s;s=e.loop&&t===e.count?0===e.active?0:t:t%e.count,i.immediate?(0,f.d1)((function(){e.swiping=!1})):e.swiping=!1,e.move({pace:s-e.active,emitChange:!0})}))},correctPosition:function(){this.swiping=!0,this.active<=-1&&this.move({pace:this.count}),this.active>=this.count&&this.move({pace:-this.count})},clear:function(){clearTimeout(this.timer)},autoPlay:function(){var t=this,i=this.autoplay;i>0&&this.count>1&&(this.clear(),this.timer=setTimeout((function(){t.next(),t.autoPlay()}),i))},genIndicator:function(){var t=this,i=this.$createElement,e=this.count,s=this.activeIndicator,a=this.slots("indicator");return a||(this.showIndicators&&e>1?i("div",{class:C("indicators",{vertical:this.vertical})},[Array.apply(void 0,Array(e)).map((function(e,a){return i("i",{class:C("indicator",{active:a===s}),style:a===s?t.indicatorStyle:null})}))]):void 0)}},render:function(){var t=arguments[0];return t("div",{class:C()},[t("div",{ref:"track",style:this.trackStyle,class:C("track",{vertical:this.vertical})},[this.slots()]),this.genIndicator()])}}),x=e(4639),S=e(4958),I=(0,r.d)("swipe-item"),k=I[0],N=I[1],P=k({mixins:[(0,b.j)("vanSwipe")],data:function(){return{offset:0,inited:!1,mounted:!1}},mounted:function(){var t=this;this.$nextTick((function(){t.mounted=!0}))},computed:{style:function(){var t={},i=this.parent,e=i.size,s=i.vertical;return e&&(t[s?"height":"width"]=e+"px"),this.offset&&(t.transform="translate"+(s?"Y":"X")+"("+this.offset+"px)"),t},shouldRender:function(){var t=this.index,i=this.inited,e=this.parent,s=this.mounted;if(!e.lazyRender||i)return!0;if(!s)return!1;var a=e.activeIndicator,o=e.count-1,n=0===a&&e.loop?o:a-1,r=a===o&&e.loop?0:a+1,l=t===a||t===n||t===r;return l&&(this.inited=!0),l}},render:function(){var t=arguments[0];return t("div",{class:N(),style:this.style,on:(0,o.Z)({},this.$listeners)},[this.shouldRender&&this.slots()])}});function z(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}var M,T={mixins:[d.D],props:{src:String,show:Boolean,active:Number,minZoom:[Number,String],maxZoom:[Number,String],rootWidth:Number,rootHeight:Number},data:function(){return{scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}},computed:{vertical:function(){var t=this.rootWidth,i=this.rootHeight,e=i/t;return this.imageRatio>e},imageStyle:function(){var t=this.scale,i={transitionDuration:this.zooming||this.moving?"0s":".3s"};if(1!==t){var e=this.moveX/t,s=this.moveY/t;i.transform="scale("+t+", "+t+") translate("+e+"px, "+s+"px)"}return i},maxMoveX:function(){if(this.imageRatio){var t=this.vertical?this.rootHeight/this.imageRatio:this.rootWidth;return Math.max(0,(this.scale*t-this.rootWidth)/2)}return 0},maxMoveY:function(){if(this.imageRatio){var t=this.vertical?this.rootHeight:this.rootWidth*this.imageRatio;return Math.max(0,(this.scale*t-this.rootHeight)/2)}return 0}},watch:{active:"resetScale",show:function(t){t||this.resetScale()}},mounted:function(){this.bindTouchEvent(this.$el)},methods:{resetScale:function(){this.setScale(1),this.moveX=0,this.moveY=0},setScale:function(t){t=(0,w.w6)(t,+this.minZoom,+this.maxZoom),t!==this.scale&&(this.scale=t,this.$emit("scale",{scale:this.scale,index:this.active}))},toggleScale:function(){var t=this.scale>1?1:2;this.setScale(t),this.moveX=0,this.moveY=0},onTouchStart:function(t){var i=t.touches,e=this.offsetX,s=void 0===e?0:e;this.touchStart(t),this.touchStartTime=new Date,this.fingerNum=i.length,this.startMoveX=this.moveX,this.startMoveY=this.moveY,this.moving=1===this.fingerNum&&1!==this.scale,this.zooming=2===this.fingerNum&&!s,this.zooming&&(this.startScale=this.scale,this.startDistance=z(t.touches))},onTouchMove:function(t){var i=t.touches;if(this.touchMove(t),(this.moving||this.zooming)&&(0,v.PF)(t,!0),this.moving){var e=this.deltaX+this.startMoveX,s=this.deltaY+this.startMoveY;this.moveX=(0,w.w6)(e,-this.maxMoveX,this.maxMoveX),this.moveY=(0,w.w6)(s,-this.maxMoveY,this.maxMoveY)}if(this.zooming&&2===i.length){var a=z(i),o=this.startScale*a/this.startDistance;this.setScale(o)}},onTouchEnd:function(t){var i=!1;(this.moving||this.zooming)&&(i=!0,this.moving&&this.startMoveX===this.moveX&&this.startMoveY===this.moveY&&(i=!1),t.touches.length||(this.zooming&&(this.moveX=(0,w.w6)(this.moveX,-this.maxMoveX,this.maxMoveX),this.moveY=(0,w.w6)(this.moveY,-this.maxMoveY,this.maxMoveY),this.zooming=!1),this.moving=!1,this.startMoveX=0,this.startMoveY=0,this.startScale=1,this.scale<1&&this.resetScale())),(0,v.PF)(t,i),this.checkTap(),this.resetTouchStatus()},checkTap:function(){var t=this;if(!(this.fingerNum>1)){var i=this.offsetX,e=void 0===i?0:i,s=this.offsetY,a=void 0===s?0:s,o=new Date-this.touchStartTime,n=250,r=5;e<r&&a<r&&o<n&&(this.doubleTapTimer?(clearTimeout(this.doubleTapTimer),this.doubleTapTimer=null,this.toggleScale()):this.doubleTapTimer=setTimeout((function(){t.$emit("close"),t.doubleTapTimer=null}),n))}},onLoad:function(t){var i=t.target,e=i.naturalWidth,s=i.naturalHeight;this.imageRatio=s/e}},render:function(){var t=arguments[0],i={loading:function(){return t(S.Z,{attrs:{type:"spinner"}})}};return t(P,{class:h("swipe-item")},[t(x.Z,{attrs:{src:this.src,fit:"contain"},class:h("image",{vertical:this.vertical}),style:this.imageStyle,scopedSlots:i,on:{load:this.onLoad}})])}},R=c({mixins:[d.D,(0,u.e)({skipToggleEvent:!0}),(0,p.X)((function(t){t(window,"resize",this.resize,!0),t(window,"orientationchange",this.resize,!0)}))],props:{className:null,closeable:Boolean,asyncClose:Boolean,overlayStyle:Object,showIndicators:Boolean,images:{type:Array,default:function(){return[]}},loop:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},minZoom:{type:[Number,String],default:1/3},maxZoom:{type:[Number,String],default:3},transition:{type:String,default:"van-fade"},showIndex:{type:Boolean,default:!0},swipeDuration:{type:[Number,String],default:300},startPosition:{type:[Number,String],default:0},overlayClass:{type:String,default:h("overlay")},closeIcon:{type:String,default:"clear"},closeOnPopstate:{type:Boolean,default:!0},closeIconPosition:{type:String,default:"top-right"}},data:function(){return{active:0,rootWidth:0,rootHeight:0,doubleClickTimer:null}},mounted:function(){this.resize()},watch:{startPosition:"setActive",value:function(t){var i=this;t?(this.setActive(+this.startPosition),this.$nextTick((function(){i.resize(),i.$refs.swipe.swipeTo(+i.startPosition,{immediate:!0})}))):this.$emit("close",{index:this.active,url:this.images[this.active]})}},methods:{resize:function(){if(this.$el&&this.$el.getBoundingClientRect){var t=this.$el.getBoundingClientRect();this.rootWidth=t.width,this.rootHeight=t.height}},emitClose:function(){this.asyncClose||this.$emit("input",!1)},emitScale:function(t){this.$emit("scale",t)},setActive:function(t){t!==this.active&&(this.active=t,this.$emit("change",t))},genIndex:function(){var t=this.$createElement;if(this.showIndex)return t("div",{class:h("index")},[this.slots("index",{index:this.active})||this.active+1+" / "+this.images.length])},genCover:function(){var t=this.$createElement,i=this.slots("cover");if(i)return t("div",{class:h("cover")},[i])},genImages:function(){var t=this,i=this.$createElement;return i(D,{ref:"swipe",attrs:{lazyRender:!0,loop:this.loop,duration:this.swipeDuration,initialSwipe:this.startPosition,showIndicators:this.showIndicators,indicatorColor:"white"},class:h("swipe"),on:{change:this.setActive}},[this.images.map((function(e){return i(T,{attrs:{src:e,show:t.value,active:t.active,maxZoom:t.maxZoom,minZoom:t.minZoom,rootWidth:t.rootWidth,rootHeight:t.rootHeight},on:{scale:t.emitScale,close:t.emitClose}})}))])},genClose:function(){var t=this.$createElement;if(this.closeable)return t(m.Z,{attrs:{role:"button",name:this.closeIcon},class:h("close-icon",this.closeIconPosition),on:{click:this.emitClose}})},onClosed:function(){this.$emit("closed")},swipeTo:function(t,i){this.$refs.swipe&&this.$refs.swipe.swipeTo(t,i)}},render:function(){var t=arguments[0];return t("transition",{attrs:{name:this.transition},on:{afterLeave:this.onClosed}},[this.shouldRender?t("div",{directives:[{name:"show",value:this.value}],class:[h(),this.className]},[this.genClose(),this.genImages(),this.genIndex(),this.genCover()]):null])}}),Z=e(3370),U={loop:!0,value:!0,images:[],maxZoom:3,minZoom:1/3,onClose:null,onChange:null,className:"",showIndex:!0,closeable:!1,closeIcon:"clear",asyncClose:!1,transition:"van-fade",getContainer:"body",overlayStyle:null,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"},E=function(){M=new(n.ZP.extend(R))({el:document.createElement("div")}),document.body.appendChild(M.$el),M.$on("change",(function(t){M.onChange&&M.onChange(t)})),M.$on("scale",(function(t){M.onScale&&M.onScale(t)}))},Y=function(t,i){if(void 0===i&&(i=0),!Z.sk){M||E();var e=Array.isArray(t)?{images:t,startPosition:i}:t;return(0,o.Z)(M,U,e),M.$once("input",(function(t){M.value=t})),M.$once("closed",(function(){M.images=[]})),e.onClose&&(M.$off("close"),M.$once("close",e.onClose)),M}};Y.Component=R,Y.install=function(){n.ZP.use(R)};var B=Y,X=(e(7658),e(408));function $(t){return Array.isArray(t)?t:[t]}function O(t,i){return new Promise((function(e){if("file"!==i){var s=new FileReader;s.onload=function(t){e(t.target.result)},"dataUrl"===i?s.readAsDataURL(t):"text"===i&&s.readAsText(t)}else e(null)}))}function L(t,i){return $(t).some((function(t){return!!t&&((0,Z.mf)(i)?i(t):t.size>i)}))}var W=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i;function F(t){return W.test(t)}function G(t){return!!t.isImage||(t.file&&t.file.type?0===t.file.type.indexOf("image"):t.url?F(t.url):!!t.content&&0===t.content.indexOf("data:image"))}var H=e(5065),j=(0,r.d)("uploader"),Q=j[0],V=j[1],J=Q({inheritAttrs:!1,mixins:[H.f],model:{prop:"fileList"},props:{disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,uploadText:String,afterRead:Function,beforeRead:Function,beforeDelete:Function,previewSize:[Number,String],previewOptions:Object,name:{type:[Number,String],default:""},accept:{type:String,default:"image/*"},fileList:{type:Array,default:function(){return[]}},maxSize:{type:[Number,String,Function],default:Number.MAX_VALUE},maxCount:{type:[Number,String],default:Number.MAX_VALUE},deletable:{type:Boolean,default:!0},showUpload:{type:Boolean,default:!0},previewImage:{type:Boolean,default:!0},previewFullImage:{type:Boolean,default:!0},imageFit:{type:String,default:"cover"},resultType:{type:String,default:"dataUrl"},uploadIcon:{type:String,default:"photograph"}},computed:{previewSizeWithUnit:function(){return(0,X.N)(this.previewSize)},value:function(){return this.fileList}},created:function(){this.urls=[]},beforeDestroy:function(){this.urls.forEach((function(t){return URL.revokeObjectURL(t)}))},methods:{getDetail:function(t){return void 0===t&&(t=this.fileList.length),{name:this.name,index:t}},onChange:function(t){var i=this,e=t.target.files;if(!this.disabled&&e.length){if(e=1===e.length?e[0]:[].slice.call(e),this.beforeRead){var s=this.beforeRead(e,this.getDetail());if(!s)return void this.resetInput();if((0,Z.tI)(s))return void s.then((function(t){t?i.readFile(t):i.readFile(e)})).catch(this.resetInput)}this.readFile(e)}},readFile:function(t){var i=this,e=L(t,this.maxSize);if(Array.isArray(t)){var s=this.maxCount-this.fileList.length;t.length>s&&(t=t.slice(0,s)),Promise.all(t.map((function(t){return O(t,i.resultType)}))).then((function(s){var a=t.map((function(t,i){var e={file:t,status:"",message:""};return s[i]&&(e.content=s[i]),e}));i.onAfterRead(a,e)}))}else O(t,this.resultType).then((function(s){var a={file:t,status:"",message:""};s&&(a.content=s),i.onAfterRead(a,e)}))},onAfterRead:function(t,i){var e=this;this.resetInput();var s=t;if(i){var a=t;Array.isArray(t)?(a=[],s=[],t.forEach((function(t){t.file&&(L(t.file,e.maxSize)?a.push(t):s.push(t))}))):s=null,this.$emit("oversize",a,this.getDetail())}var o=Array.isArray(s)?Boolean(s.length):Boolean(s);o&&(this.$emit("input",[].concat(this.fileList,$(s))),this.afterRead&&this.afterRead(s,this.getDetail()))},onDelete:function(t,i){var e,s=this,a=null!=(e=t.beforeDelete)?e:this.beforeDelete;if(a){var o=a(t,this.getDetail(i));if(!o)return;if((0,Z.tI)(o))return void o.then((function(){s.deleteFile(t,i)})).catch(Z.ZT)}this.deleteFile(t,i)},deleteFile:function(t,i){var e=this.fileList.slice(0);e.splice(i,1),this.$emit("input",e),this.$emit("delete",t,this.getDetail(i))},resetInput:function(){this.$refs.input&&(this.$refs.input.value="")},onClickUpload:function(t){this.$emit("click-upload",t)},onPreviewImage:function(t){var i=this;if(this.previewFullImage){var e=this.fileList.filter((function(t){return G(t)})),s=e.map((function(t){return t.file&&!t.url&&"failed"!==t.status&&(t.url=URL.createObjectURL(t.file),i.urls.push(t.url)),t.url}));this.imagePreview=B((0,o.Z)({images:s,startPosition:e.indexOf(t),onClose:function(){i.$emit("close-preview")}},this.previewOptions))}},closeImagePreview:function(){this.imagePreview&&this.imagePreview.close()},chooseFile:function(){this.disabled||this.$refs.input&&this.$refs.input.click()},genPreviewMask:function(t){var i=this.$createElement,e=t.status,s=t.message;if("uploading"===e||"failed"===e){var a="failed"===e?i(m.Z,{attrs:{name:"close"},class:V("mask-icon")}):i(S.Z,{class:V("loading")}),o=(0,Z.Xq)(s)&&""!==s;return i("div",{class:V("mask")},[a,o&&i("div",{class:V("mask-message")},[s])])}},genPreviewItem:function(t,i){var e,s,a,n=this,r=this.$createElement,l=null!=(e=t.deletable)?e:this.deletable,c="uploading"!==t.status&&l,h=c&&r("div",{class:V("preview-delete"),on:{click:function(e){e.stopPropagation(),n.onDelete(t,i)}}},[r(m.Z,{attrs:{name:"cross"},class:V("preview-delete-icon")})]),u=this.slots("preview-cover",(0,o.Z)({index:i},t)),d=u&&r("div",{class:V("preview-cover")},[u]),p=null!=(s=t.previewSize)?s:this.previewSize,g=null!=(a=t.imageFit)?a:this.imageFit,v=G(t)?r(x.Z,{attrs:{fit:g,src:t.content||t.url,width:p,height:p,lazyLoad:this.lazyLoad},class:V("preview-image"),on:{click:function(){n.onPreviewImage(t)}}},[d]):r("div",{class:V("file"),style:{width:this.previewSizeWithUnit,height:this.previewSizeWithUnit}},[r(m.Z,{class:V("file-icon"),attrs:{name:"description"}}),r("div",{class:[V("file-name"),"van-ellipsis"]},[t.file?t.file.name:t.url]),d]);return r("div",{class:V("preview"),on:{click:function(){n.$emit("click-preview",t,n.getDetail(i))}}},[v,this.genPreviewMask(t),h])},genPreviewList:function(){if(this.previewImage)return this.fileList.map(this.genPreviewItem)},genUpload:function(){var t=this.$createElement;if(!(this.fileList.length>=this.maxCount)){var i,e=this.slots(),s=this.readonly?null:t("input",{attrs:(0,o.Z)({},this.$attrs,{type:"file",accept:this.accept,disabled:this.disabled}),ref:"input",class:V("input"),on:{change:this.onChange}});if(e)return t("div",{class:V("input-wrapper"),key:"input-wrapper",on:{click:this.onClickUpload}},[e,s]);if(this.previewSize){var a=this.previewSizeWithUnit;i={width:a,height:a}}return t("div",{directives:[{name:"show",value:this.showUpload}],class:V("upload",{readonly:this.readonly}),style:i,on:{click:this.onClickUpload}},[t(m.Z,{attrs:{name:this.uploadIcon},class:V("upload-icon")}),this.uploadText&&t("span",{class:V("upload-text")},[this.uploadText]),s])}}},render:function(){var t=arguments[0];return t("div",{class:V()},[t("div",{class:V("wrapper",{disabled:this.disabled})},[this.genPreviewList(),this.genUpload()])])}}),K=e(5928),_=e(9093),q={name:"editAttribute",components:{PickerPopup:_.Z,[J.name]:J},data(){return{id:"",index:-1,ruleData:{},goodsData:{},goodsImgs:[],imageMaxSize:2,imageDefalutUrl:"",headUrl:""}},methods:{afterRead(t){t&&(0,K._s)(t.file,{appproductId:this.id}).then((i=>{this.$toast("上传成功"),this.addUploadImg(t.content,i.data)})).catch((t=>{console.log(t),this.$toast(t.msg)}))},addUploadImg(t,i){const e=this.goodsImgs;if(null==e||0===e.length||0===i.length)return;const s=e[0],a=i[0];if("default"===s.type)s.type="custom",s.url=t,s.headImg=!1,s.id=a.id,this.goodsImgs=e,this.updateDeq(0);else{const i=e[e.length-1];"add"===i.type&&(i.type="custom",i.url=t,i.headImg=!1,i.id=a.id,this.goodsImgs=e),e.length<this.imageMaxSize&&e.push({url:"img_upload.png",type:"add"})}},imgClick(t,i){"add"===t?this.bindAddImg():this.bindPreviewImage(i)},bindAddImg(){},bindPreviewImage(t){B([t])},rawOpeningPopup(t){this.goodsData.rawOpeningName=t.displayName},originPopup(t){this.goodsData.originName=t.displayName},flowerPopup(t){this.goodsData.flowerHeadStateName=t.displayName},meritPopup(t){this.goodsData.merit=t.displayName},defectPopup(t){this.goodsData.defect=t.displayName},bindPickerRawOpeningName(){this.$refs.rawOpeningPopup.showPopup()},bindPickerOriginName(){this.$refs.originPopup.showPopup()},bindPickerflowerHeadStateName(){this.$refs.flowerPopup.showPopup()},bindPickerMerit(){this.$refs.meritPopup.showPopup()},bindPickerDefect(){this.$refs.defectPopup.showPopup()},bindHeadImg(t){const i=this.goodsImgs;if(0===i.length)return;const e=i[t];!0!==e.headImg&&this.updateDeq(t)},updateDeq(t){const i=this.goodsImgs;(0,K.dM)({approductId:this.id,seq:"1",id:i[t].id}).then((e=>{let s="";for(let a=0;a<i.length;a++){const e=i[a];a===t?(s=e.url,e.headImg=!0):e.headImg=!1}this.goodsImgs=i,this.headUrl=s})).catch((t=>{this.$toast(t.msg)}))},bindDelete(t){const i=this.goodsImgs;if(0===i.length)return;const e=i[t];(0,K.yo)({id:e.id}).then((s=>{if(i.length>2)i.splice(t,1),!0===e.headImg&&this.updateDeq(0);else if(2===i.length){const s=i[1];if("add"===s.type){const t=i[0];t.type="default",t.url=this.imageDefalutUrl,t.headImg=!1,this.headUrl=this.imageDefalutUrl}else i.splice(t,1),i.push({url:"img_upload.png",type:"add"}),!0===e.headImg&&this.updateDeq(0)}this.goodsImgs=i})).catch((t=>{this.$toast(t.msg)}))},getImgUrl(t){return void 0===t||""===t||null==t?"":t},handleSubmit(){const t=this.goodsData,i={productId:this.id,length:t.length,width:t.width,height:t.height,rawOpeningName:t.rawOpeningName,originName:t.originName,flowerHeadStateName:t.flowerHeadStateName,merit:t.merit,defect:t.defect,productRemark:t.productRemark};(0,K.zG)(i).then((t=>{this.$router.back(),this.$toast.success("保存成功")})).catch((t=>{this.$toast(t.msg)}))},getRule(){(0,K.CQ)({productId:this.id}).then((t=>{this.ruleData=t.data,this.$forceUpdate()})).catch((t=>{this.$toast(t.msg)}))},getProductListAll(){(0,K.G0)({id:this.id}).then((t=>{const i=t.data,e=i.imageUrlList,s=this.goodsImgs;let a=i.imageUrl;if(null!=a&&""!==a&&(a=this.baseUrl+a),void 0!==e&&e.length>0){e.sort(((t,i)=>i.seq-t.seq));for(let t=0;t<e.length;t++){const i=e[t];let a=!1;0===t&&(a=!0),s.push({url:this.baseUrl+i.url,type:"custom",headImg:a,id:i.id})}e.length<this.imageMaxSize&&s.push({url:"img_upload.png",type:"add"})}else s.push({url:a,type:"default"}),s.push({url:"img_upload.png",type:"add"});this.goodsData=i,this.goodsImgs=s,this.imageDefalutUrl=a})).catch((t=>{this.$toast(t.msg)}))}},mounted(){this.id=this.$route.query.id,this.index=this.$route.query.index,this.getRule(),this.getProductListAll()}},tt=q,it=e(1001),et=(0,it.Z)(tt,s,a,!1,null,"836b9ce4",null),st=et.exports},5065:function(t,i,e){e.d(i,{f:function(){return s}});var s={inject:{vanField:{default:null}},watch:{value:function(){var t=this.vanField;t&&(t.resetValidation(),t.validateWithTrigger("onChange"))}},created:function(){var t=this.vanField;t&&!t.children&&(t.children=this)}}},7799:function(t,i,e){e.d(i,{Wn:function(){return l},d1:function(){return c}});var s=e(3370),a=Date.now();function o(t){var i=Date.now(),e=Math.max(0,16-(i-a)),s=setTimeout(t,e);return a=i+e,s}var n=s.sk?e.g:window,r=n.requestAnimationFrame||o;n.cancelAnimationFrame||n.clearTimeout;function l(t){return r.call(n,t)}function c(t){l((function(){l(t)}))}},4292:function(t,i,e){function s(t){var i=window.getComputedStyle(t),e="none"===i.display,s=null===t.offsetParent&&"fixed"!==i.position;return e||s}e.d(i,{x:function(){return s}})},1757:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjdFNjM5NjZFQzQxMTFFNzg4NTQ4Njg4NEM0RDZCRUQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjdFNjM5NjdFQzQxMTFFNzg4NTQ4Njg4NEM0RDZCRUQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBQTJBMDc3RkVDNDExMUU3ODg1NDg2ODg0QzRENkJFRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBQTJBMDc4MEVDNDExMUU3ODg1NDg2ODg0QzRENkJFRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pj55NGsAAALVSURBVHjatJZPSxthEMaf3UhUbPyHkChGLA148apQm0pQSdTY0FNPLRXar1BoP0E/g9CWQq89maShxmCoNUqptxykqSgqIRXRg4r/SNKZdWJVNrtrEx/4kcC+O8/uzLz7jjI1NQUTKcRDIkg8IDxEi1zbI34TKSJCzBNFo2A1BtdUYpJ4IyZ6cgr8IK/E/C3xkSiUC6qnu8QS8d7ATE8euWdJYlgy9BE/iD78v/okxqCZoZ/4SrShcnGMOBEoZ9hDfCbsqJ7sErPnuqGN+EQ4UH3dkdi2y4bPK6yZlZpOlgwVaX1dNTc3IxQKoampqfzeqqnB6Ogo2toMS/+avVTppLKt7/V64XK5NFO9gKqqwu/3o6urCwMDA2ZbZpANx41WxeNxbG9vo76+HhMTE+jo6Pj3CVIUjIyMoLOzE/v7+0gkEmapHWdDw8c6OTlBJBLB5uYm7HY7xsbG0N3dfb5hfT7t/+HhIaLRqPZrovsKfUtz8nkyFKeODTweD4rFInK5HNrb23F8fKw90O7urpXm+aNe+hAbqlAoYG5uDul0Wkslm+XzecRiMatmrBb1Jr3Nb1apVDliYCWlQ0ND6O3tvUipzWbTatra2mrVb48NM2areJ8FAgGtfpzG2dlZTE9PI5PJoK6uTjNtbGy0YviLDReNVtTW1iIYDMLtduPs7Eyr2dramnYtmUxifX0dDQ0N2hr+NdEiG0aNVvA+czqdODo6QjgcRjabvVJTftutrS04HA4MDw+bGX5hw29yUutqYWFBqxencGdnR7d7Z2ZmsLGxgVQqZWTGHvOKzDQviHe4Xb3kaaC0LXgG+XmLZsvicXE85YlnxMEtmHHMp+Jx5cRfIZ4Qp1U0O5WYK+VmmhjxuEpveiCxYmZTW0xO6OUKa9Z33cxoLuUU9Ev3rt7AaFXu6b+cRquTN0/OH6S7vMQjOTvvXRv1V2XUDxPfy03cJf0VYABaptzo0AYr8gAAAABJRU5ErkJggg=="},6830:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAflBMVEUAAADAwMC/v7+7u7u9vb3Dw8O/v7/ExMTAwMC/v7+/v7+/v7++vr7CwsK+vr6/v7+/v7/AwMDAwMC/v7/AwMDAwMC+vr6/v7+/v7+/v7/AwMC9vb29vb2/v7+/v7+6urrAwMDAwMC/v7+/v7+9vb2/v7+/v7+/v7+/v7+/v78r7yweAAAAKXRSTlMA3vsiGxHtDRXNiGg0BKqbjJnyQ+K9eiu6sK1GI5V3EufZw1gKTT2BpAOXLDwAAAH3SURBVHja7dltr5pAEIbhYQXkRXxDXU97KAro6fz/P9jEHSULbdJuNjsxnfvjEz9cickEArzK0epA83e0K2k/2vOe5hXanWj/NtnvQHEBNDcg5gYMzAAFzIALN+DKDejgVX+763gAvoxIHSBsWW76ACQBhC1GUyQAAQhAAAIQAD+goCBsWWTqQJIk9namBsJW1aY7/yV8b4Buuq6I+QCleryX3rgAtaI3408mwBGpDRNAIXXlASzxWSoAAQjgrQEJFRgwlKZ+nIICxgQgAH5AQnEBuA5Rdjb95L+EfwmoklnxCEjmVV4BdafwH1PnlT9AqdAhdfMF0AqdSltPgC06VnoCHF0BG0+Asyug8QT4cgX0ngBZik5dK08AqPfo0EH7O0Rxk0fz8JmK5uVf7Zs8FbMDdqYmNCA15fxPRAIQgAAKKjCgWpk0/yUUgAAE4A4YXoALDwD2SOVMgDVSBRNA7+kfyJgAUF8e7x8auACwLJttX/3Pn259ABYUhG35w1SCJEnsMR2idm1q+C+hAAQgAAEIQADsgDUFYcvy60U9AKNpYdXSnC3sKjNXkzkDUzv7uem3Px9ivRoBKVptad6gXUauybz5w1fWT/JO5g+Yp5gBS2QGxNwAzQ2ouQE3bkAf2Z1oLyZ7YuZ2MhdgOk32mACTeQfPfgF4QgPZgUnEswAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=932.6b70c34c.js.map