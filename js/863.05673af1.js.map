{"version":3,"file":"js/863.05673af1.js","mappings":"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","sources":["webpack://flower_shop/./src/views/goodsTab/GoodsSearch.vue","webpack://flower_shop/src/views/goodsTab/GoodsSearch.vue","webpack://flower_shop/./src/views/goodsTab/GoodsSearch.vue?3a1f","webpack://flower_shop/./src/views/goodsTab/GoodsSearch.vue?5407","webpack://flower_shop/./node_modules/vant/es/utils/router.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"root\"},[_c('action-bar',{attrs:{\"border\":false,\"title\":\"商品搜索\"}}),_c('div',{staticClass:\"search\"},[_c('div',{staticClass:\"search-content\"},[_c('van-icon',{staticClass:\"search-icon\",attrs:{\"name\":\"search\",\"color\":\"#b4b4b4\",\"size\":\"16px\"}}),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.searchStr),expression:\"searchStr\"}],staticClass:\"search-input\",attrs:{\"type\":\"text\",\"maxlength\":\"36\",\"placeholder\":\"搜索你想要的商品\"},domProps:{\"value\":(_vm.searchStr)},on:{\"input\":function($event){if($event.target.composing)return;_vm.searchStr=$event.target.value}}}),_c('div',[(_vm.searchStr != '')?_c('div',{staticClass:\"search-del\",on:{\"click\":_vm.bindClearSearch}},[_c('van-icon',{attrs:{\"name\":\"cross\",\"color\":\"#fff\",\"size\":\"2px\"}})],1):_vm._e()])],1),_c('div',{staticClass:\"search-btn\",on:{\"click\":_vm.handleSearch}},[_vm._v(\"搜索\")])]),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"content\"},[(_vm.showHistory)?_c('div',{staticClass:\"history\"},[_c('div',{staticClass:\"history-head\"},[_c('div',{staticClass:\"history-head-title\"},[_vm._v(\"搜索历史\")]),_c('img',{staticClass:\"history-head-del\",attrs:{\"src\":require(\"@/assets/commoidy_delete_.png\")},on:{\"click\":_vm.bindDelAllHistory}})]),_vm._l((_vm.historyList),function(item){return _c('div',{key:item,staticClass:\"history-item\",on:{\"click\":function($event){return _vm.bindHistoryItem(item)}}},[_vm._v(\" \"+_vm._s(item)+\" \")])})],2):_c('scroll-view',{staticClass:\"scroll\",attrs:{\"noMoreData\":_vm.noMoreData,\"data\":_vm.searchList}},_vm._l((_vm.searchList),function(item,index){return _c('goods-item',{key:item.productId},[_c('van-image',{staticClass:\"goods-img\",attrs:{\"slot\":\"imgSlot\",\"radius\":\".25rem\",\"src\":_vm.baseUrl + item.imageUrl},slot:\"imgSlot\"}),_c('div',{staticClass:\"title\",attrs:{\"slot\":\"nameSlot\"},slot:\"nameSlot\"},[_c('div',{staticClass:\"status\"},[_c('div',{class:item.state == '已下架' ? 'removed' : ''},[_vm._v(_vm._s(item.state)+\" \")])]),_c('div',[_vm._v(_vm._s(item.productName))])]),_c('div',{attrs:{\"slot\":\"attributeSlot\"},slot:\"attributeSlot\"},[_c('div',{staticClass:\"attribute\"},[_c('div',{staticClass:\"attribute-content\"},[_vm._v(\"售价：\"+_vm._s(item.price))]),_c('div',{staticClass:\"attribute-content\"},[_vm._v(\"库存：\"+_vm._s(item.stock))])]),_c('div',{staticClass:\"attribute\"},[_c('div',{staticClass:\"attribute-content\"},[_vm._v(\"规格：\"+_vm._s(item.unit))]),_c('div',{staticClass:\"attribute-content\"},[_vm._v(\"销量：\"+_vm._s(item.salesVolume))])])]),_c('div',{staticClass:\"menu\",attrs:{\"slot\":\"menuSlot\"},slot:\"menuSlot\"},[_c('div',{staticClass:\"small\",on:{\"click\":function($event){return _vm.handleUpdatePriceStock(item.productId, index)}}},[_c('img',{staticClass:\"small-icon\",attrs:{\"src\":require(\"@/assets/commoidy_price_stock.png\")}}),_vm._v(\"价&库 \")]),_c('div',{staticClass:\"small\",attrs:{\"bindtap\":\"handleUpdateGoods\"}},[_c('img',{staticClass:\"small-icon\",attrs:{\"src\":require(\"@/assets/commoidy_edit_.png\")}}),_vm._v(\"编辑 \")]),(item.state == '出售中')?[_c('div',{staticClass:\"small\",on:{\"click\":function($event){return _vm.handlePutOff(item.productId, '0', index)}}},[_c('img',{staticClass:\"small-icon\",attrs:{\"src\":require(\"@/assets/commoidy_offsale.png\")}}),_vm._v(\"下架 \")])]:[_c('div',{staticClass:\"small\",on:{\"click\":function($event){return _vm.handlePutOn(item.productId, '1', index)}}},[_c('img',{staticClass:\"small-icon\",attrs:{\"src\":require(\"@/assets/commoidy_onsale.png\")}}),_vm._v(\"上架 \")])],_c('div',{staticClass:\"small\",on:{\"click\":function($event){return _vm.handleDeleteGoods(item.productId)}}},[_c('img',{staticClass:\"small-icon\",attrs:{\"src\":require(\"@/assets/commoidy_recovery.png\")}}),_vm._v(\" 移除 \")])],2)],1)}),1)],1)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class='root'>\r\n    <action-bar :border=\"false\" title='商品搜索'></action-bar>\r\n    <div class=\"search\">\r\n      <div class=\"search-content\">\r\n        <van-icon name=\"search\" color=\"#b4b4b4\" class=\"search-icon\" size=\"16px\" />\r\n        <input v-model=\"searchStr\" type=\"text\" maxlength=\"36\" class=\"search-input\" placeholder=\"搜索你想要的商品\" />\r\n        <div>\r\n          <div class=\"search-del\" v-if=\"searchStr != ''\" @click=\"bindClearSearch\">\r\n            <van-icon name=\"cross\" color=\"#fff\" size=\"2px\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"search-btn\" @click=\"handleSearch\">搜索</div>\r\n    </div>\r\n    <div class='container'>\r\n      <div class='content'>\r\n        <div v-if=\"showHistory\" class=\"history\">\r\n          <div class=\"history-head\">\r\n            <div class=\"history-head-title\">搜索历史</div>\r\n            <img class=\"history-head-del\" src=\"@/assets/commoidy_delete_.png\" @click=\"bindDelAllHistory\" />\r\n          </div>\r\n          <div v-for=\"item in historyList\" :key=\"item\" class=\"history-item\" @click=\"bindHistoryItem(item)\">\r\n            {{ item }}\r\n          </div>\r\n        </div>\r\n        <scroll-view :noMoreData=\"noMoreData\" v-else class=\"scroll\" :data=\"searchList\">\r\n          <goods-item v-for=\"(item, index) in searchList\" :key=\"item.productId\">\r\n            <van-image slot=\"imgSlot\" radius=\".25rem\" :src=\"baseUrl + item.imageUrl\" class=\"goods-img\" />\r\n            <div class=\"title\" slot=\"nameSlot\">\r\n              <div class=\"status\">\r\n                <div :class=\"item.state == '已下架' ? 'removed' : ''\">{{ item.state }}\r\n                </div>\r\n              </div>\r\n              <div>{{ item.productName }}</div>\r\n            </div>\r\n            <div slot=\"attributeSlot\">\r\n              <div class=\"attribute\">\r\n                <div class=\"attribute-content\">售价：{{ item.price }}</div>\r\n                <div class=\"attribute-content\">库存：{{ item.stock }}</div>\r\n              </div>\r\n              <div class=\"attribute\">\r\n                <div class=\"attribute-content\">规格：{{ item.unit }}</div>\r\n                <div class=\"attribute-content\">销量：{{ item.salesVolume }}</div>\r\n              </div>\r\n            </div>\r\n            <div slot=\"menuSlot\" class=\"menu\">\r\n              <div class=\"small\" @click=\"handleUpdatePriceStock(item.productId, index)\">\r\n                <img class=\"small-icon\" src=\"@/assets/commoidy_price_stock.png\" />价&库\r\n              </div>\r\n              <div class=\"small\" bindtap=\"handleUpdateGoods\">\r\n                <img class=\"small-icon\" src=\"@/assets/commoidy_edit_.png\" />编辑\r\n              </div>\r\n              <template v-if=\"item.state == '出售中'\">\r\n                <div class=\"small\" @click=\"handlePutOff(item.productId, '0', index)\">\r\n                  <img class=\"small-icon\" src=\"@/assets/commoidy_offsale.png\" />下架\r\n                </div>\r\n              </template>\r\n              <template v-else>\r\n                <div class=\"small\" @click=\"handlePutOn(item.productId, '1', index)\">\r\n                  <img class=\"small-icon\" src=\"@/assets/commoidy_onsale.png\" />上架\r\n                </div>\r\n              </template>\r\n              <div class=\"small\" @click=\"handleDeleteGoods(item.productId)\">\r\n                <img class=\"small-icon\" src=\"@/assets/commoidy_recovery.png\" />\r\n                移除\r\n              </div>\r\n\r\n            </div>\r\n          </goods-item>\r\n        </scroll-view>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n\r\nimport { Icon, Dialog } from 'vant'\r\nimport { productOperate, productRemove, productSearch } from '@/http/api'\r\nimport goodsItem from '@/components/util/GoodsItem.vue'\r\n\r\nconst GOODS_LENGTH = 50 // 历史记录最大数量\r\n\r\nexport default {\r\n  name: 'goodsSearch',\r\n  components: {\r\n    [Icon.name]: Icon,\r\n    goodsItem,\r\n    [Dialog.name]: Dialog.Component\r\n  },\r\n  data () {\r\n    return {\r\n      searchList: [], // 搜索结果\r\n      searchStr: '', // 搜索文本内容\r\n      isScroll: true, // 是否可滑动\r\n      noMoreData: false, // 没有更多数据了\r\n      start: 0,\r\n      limit: 10,\r\n      isRequest: false,\r\n      showHistory: true, // 是否显示历史搜索记录\r\n      historyList: [] // 历史记录集合\r\n    }\r\n  },\r\n  beforeRouteEnter (to, from, next) {\r\n    next()\r\n    const goodsData = from.params.goodsData\r\n    if (goodsData) {\r\n      next(vm => {\r\n        if (goodsData !== undefined && goodsData !== null) {\r\n          const searchList = vm.searchList\r\n          for (const item of goodsData) {\r\n            const obj = searchList[item.index]\r\n            if (obj != null && obj !== undefined) {\r\n              obj.price = item.price\r\n              obj.stock = item.stock\r\n            }\r\n          }\r\n          vm.searchList = searchList\r\n        }\r\n      })\r\n    }\r\n    const headData = from.params.headData\r\n    next(vm => {\r\n      if (headData !== undefined && headData != null) {\r\n        const searchList = vm.searchList\r\n        searchList[headData.index].imageUrl = headData.headUrl\r\n        vm.searchList = searchList\r\n      }\r\n    })\r\n  },\r\n  methods: {\r\n    bindHistoryItem (content) {\r\n      this.searchStr = content\r\n      this.handleSearch()\r\n    },\r\n    // 删除所有历史记录\r\n    bindDelAllHistory () {\r\n      Dialog.confirm({\r\n        title: '温馨提示',\r\n        message: '确定将所有历史记录删除吗？',\r\n        confirmButtonText: '确定',\r\n        confirmButtonColor: '#FF0000'\r\n      })\r\n        .then(() => {\r\n          // on confirm\r\n          this.clearAllHistory()\r\n        })\r\n        .catch(() => {\r\n          // on cancel\r\n        })\r\n    },\r\n    clearAllHistory () {\r\n      this.historyList = []\r\n      this.saveHistory()\r\n    },\r\n    // 上架\r\n    handlePutOn (id, onsale, index) {\r\n      this.goodsOffOnConfirm(id, onsale, '温馨提示', '确定将商品上架吗？', '#42D18A', onsale, index)\r\n    },\r\n    // 下架\r\n    handlePutOff (id, onsale, index) {\r\n      this.goodsOffOnConfirm(id, onsale, '温馨提示', '确定将商品下架吗？', '#FF0000', onsale, index)\r\n    },\r\n    goodsOffOnConfirm (id, onsale, title, content, confirmColor, onsaleStatus, index) {\r\n      const that = this\r\n      Dialog.confirm({\r\n        title: title,\r\n        message: content,\r\n        confirmButtonText: '确定',\r\n        confirmButtonColor: confirmColor\r\n      })\r\n        .then(() => {\r\n          // on confirm\r\n          that.requestProductOperate(id, onsale, onsaleStatus, index)\r\n        })\r\n        .catch(() => {\r\n          // on cancel\r\n        })\r\n    },\r\n    // 上下架接口请求\r\n    requestProductOperate (productIds, onsale, onsaleStatus = -1, index = -1) {\r\n      productOperate({\r\n        productIds,\r\n        onsale\r\n      }).then(res => {\r\n        const searchList = this.searchList\r\n        const goods = searchList[index]\r\n        if (goods) {\r\n          if (onsale === '1') {\r\n            goods.state = '出售中'\r\n          } else {\r\n            goods.state = '已下架'\r\n          }\r\n          this.searchList = searchList\r\n        }\r\n        setTimeout(() => {\r\n          this.$toast.success('操作成功')\r\n        }, 150)\r\n      }).catch(res => {\r\n        this.$toast(res.msg)\r\n      })\r\n    },\r\n    // 删除商品\r\n    requestDelete (productIds, state) {\r\n      productRemove({\r\n        productIds,\r\n        state\r\n      }).then(res => {\r\n        setTimeout(() => {\r\n          this.$toast.success('移除成功')\r\n        }, 150)\r\n        this.handleSearch()\r\n      }).catch(res => {\r\n        this.$toast(res.msg)\r\n      })\r\n    },\r\n    // 移除商品\r\n    handleDeleteGoods (id) {\r\n      const that = this\r\n      Dialog.confirm({\r\n        title: '温馨提示',\r\n        message: '确定要将该商品移入回收站吗？',\r\n        confirmButtonText: '确定',\r\n        confirmButtonColor: '#E81A2E'\r\n      })\r\n        .then(() => {\r\n          // on confirm\r\n          that.requestDelete(id, 1)\r\n        })\r\n        .catch(() => {\r\n          // on cancel\r\n        })\r\n    },\r\n    handleUpdatePriceStock (productId, index) {\r\n      this.$router.push({\r\n        path: '/updatePriceStock',\r\n        query: {\r\n          data: [{\r\n            productId,\r\n            index\r\n          }]\r\n        }\r\n      })\r\n    },\r\n    bindClearSearch () {\r\n      this.searchStr = ''\r\n      this.showHistory = true\r\n    },\r\n    // 搜索\r\n    handleSearch () {\r\n      const searchStr = this.searchStr.trim()\r\n      if (searchStr === '') {\r\n        this.$toast('请输入搜索内容')\r\n        return\r\n      }\r\n      if (this.isRequest) {\r\n        return\r\n      }\r\n      this.putStrHistory(searchStr)\r\n      this.start = 0\r\n      this.searchList = []\r\n      this.showHistory = false\r\n      this.requestData()\r\n    },\r\n    // 确定历史中是否存在，有则将之置为第一个，没有则在首位增加，并判断是否超出最大数量限制，超出则删除末尾\r\n    putStrHistory (str) {\r\n      const historyList = this.historyList\r\n      const searchIndex = historyList.indexOf(str)\r\n      if (searchIndex === -1) {\r\n        // 未找到\r\n        historyList.unshift(str)\r\n      } else if (searchIndex === 0) {\r\n        return\r\n      } else {\r\n        // 删除并在首位添加\r\n        historyList.splice(searchIndex, 1)\r\n        historyList.unshift(str)\r\n      }\r\n      if (historyList.length > GOODS_LENGTH) {\r\n        historyList.splice(historyList.length - 1, 1)\r\n      }\r\n      this.historyList = historyList\r\n      this.saveHistory()\r\n    },\r\n    // 存储历史记录\r\n    saveHistory () {\r\n      this.$store.commit('setSalesGoodsSearchList', this.historyList)\r\n    },\r\n    // 请求接口\r\n    requestData () {\r\n      this.isRequest = true\r\n      productSearch({\r\n        name: this.searchStr,\r\n        start: this.start,\r\n        limit: this.limit\r\n      }).then(res => {\r\n        let nmd = false\r\n        if (res.data.result.length < 10) {\r\n          nmd = true\r\n        }\r\n        const searchList = this.searchList\r\n        searchList.push(...res.data.result)\r\n        this.noMoreData = nmd\r\n        this.searchList = searchList\r\n        this.isRequest = false\r\n        if (this.searchList.length === 0) {\r\n          this.$toast('未搜索到商品')\r\n        }\r\n      }).catch(rej => {\r\n        this.setData({\r\n          isScroll: true,\r\n          isRequest: false\r\n        })\r\n        this.isRequest = false\r\n        this.$toast(rej.msg)\r\n      })\r\n    },\r\n    initHistory () {\r\n      this.historyList = this.$store.state.salesGoodsSearchList\r\n    }\r\n  },\r\n  mounted () {\r\n    this.initHistory()\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.root {\r\n  width: 100vw;\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.container {\r\n  flex-grow: 1;\r\n  position: relative;\r\n}\r\n\r\n.content {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n}\r\n\r\n.search {\r\n  height: 2.625rem;\r\n  box-sizing: border-box;\r\n  padding: .1875rem .625rem;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.search-content {\r\n  display: flex;\r\n  flex-direction: row;\r\n  background-color: #F2F2F2;\r\n  border-radius: .25rem;\r\n  width: 82%;\r\n  height: 100%;\r\n  align-items: center;\r\n}\r\n\r\n.search-icon {\r\n  margin-left: .25rem;\r\n}\r\n\r\n.search-input::placeholder {\r\n  color: #b4b4b4;\r\n  font-size: .75rem;\r\n}\r\n\r\n.search-input {\r\n  width: 100%;\r\n  max-lines: 1;\r\n  color: #333;\r\n  height: 1.625rem;\r\n  padding-left: .25rem;\r\n  border: none;\r\n  background: #F2F2F2;\r\n}\r\n\r\n.search-del {\r\n  border-radius: 50%;\r\n  background: #8b8b8ba4;\r\n  width: 16px;\r\n  height: 16px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin: 0 .375rem;\r\n}\r\n\r\n.search-btn {\r\n  width: 20%;\r\n  height: 100%;\r\n  margin-left: .625rem;\r\n  background-color: #42D18A;\r\n  border-radius: .25rem;\r\n  color: white;\r\n  display: flex;\r\n  font-size: .875rem;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.history {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: .625rem .3125rem;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.history-head {\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin: 0 .3125rem;\r\n  margin-bottom: .375rem;\r\n}\r\n\r\n.history-head-title {\r\n  font-size: .9375rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.history-item {\r\n  display: inline-block;\r\n  padding: .3125rem .75rem;\r\n  border-radius: 1.125rem;\r\n  margin: .25rem;\r\n  background: #ececec;\r\n}\r\n\r\n.history-head-del {\r\n  width: auto;\r\n  height: 1.0625rem;\r\n  padding-left: .8125rem;\r\n  padding-top: .375rem;\r\n  padding-bottom: .375rem;\r\n}\r\n\r\n.goods-img {\r\n  width: 20vw;\r\n  height: 20vw;\r\n  border-radius: .25rem;\r\n  background-color: #F2F2F2;\r\n  margin-right: .25rem;\r\n}\r\n\r\n.list .scroll {\r\n  background-color: white;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.title {\r\n  font-size: .75rem;\r\n}\r\n\r\n.status {\r\n  color: red;\r\n  float: right;\r\n}\r\n\r\n.removed {\r\n  color: #A6B0BD;\r\n}\r\n\r\n.attribute {\r\n  display: flex;\r\n  flex-direction: row;\r\n  font-size: .625rem;\r\n}\r\n\r\n.attribute-content {\r\n  width: 50%;\r\n}\r\n\r\n.menu {\r\n  display: flex;\r\n  flex-direction: row;\r\n  color: #888F9F;\r\n  font-size: .8125rem;\r\n  align-items: center;\r\n  margin-bottom: .375rem;\r\n  margin-top: .1875rem;\r\n  margin-left: .1875rem;\r\n}\r\n\r\n.small {\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  padding-right: .8125rem;\r\n  font-size: .875rem;\r\n  padding-top: .375rem;\r\n  padding-bottom: .375rem;\r\n}\r\n\r\n.small-icon {\r\n  width: 1.0625rem;\r\n  height: 1.0625rem;\r\n  margin-right: .0938rem;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./GoodsSearch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./GoodsSearch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GoodsSearch.vue?vue&type=template&id=2cf68b7d&scoped=true&\"\nimport script from \"./GoodsSearch.vue?vue&type=script&lang=js&\"\nexport * from \"./GoodsSearch.vue?vue&type=script&lang=js&\"\nimport style0 from \"./GoodsSearch.vue?vue&type=style&index=0&id=2cf68b7d&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2cf68b7d\",\n  null\n  \n)\n\nexport default component.exports","/**\n * Vue Router support\n */\nfunction isRedundantNavigation(err) {\n  return err.name === 'NavigationDuplicated' || // compatible with vue-router@3.3\n  err.message && err.message.indexOf('redundant navigation') !== -1;\n}\n\nexport function route(router, config) {\n  var to = config.to,\n      url = config.url,\n      replace = config.replace;\n\n  if (to && router) {\n    var promise = router[replace ? 'replace' : 'push'](to);\n    /* istanbul ignore else */\n\n    if (promise && promise.catch) {\n      promise.catch(function (err) {\n        if (err && !isRedundantNavigation(err)) {\n          throw err;\n        }\n      });\n    }\n  } else if (url) {\n    replace ? location.replace(url) : location.href = url;\n  }\n}\nexport function functionalRoute(context) {\n  route(context.parent && context.parent.$router, context.props);\n}\nexport var routeProps = {\n  url: String,\n  replace: Boolean,\n  to: [String, Object]\n};"],"names":["render","_vm","this","_c","_self","staticClass","attrs","directives","name","rawName","value","searchStr","expression","domProps","on","$event","target","composing","bindClearSearch","_e","handleSearch","_v","showHistory","require","bindDelAllHistory","_l","historyList","item","key","bindHistoryItem","_s","noMoreData","searchList","index","productId","baseUrl","imageUrl","slot","class","state","productName","price","stock","unit","salesVolume","handleUpdatePriceStock","handlePutOff","handlePutOn","handleDeleteGoods","staticRenderFns","GOODS_LENGTH","components","goodsItem","data","isScroll","start","limit","isRequest","beforeRouteEnter","next","obj","vm","methods","title","message","confirmButtonText","confirmButtonColor","then","catch","clearAllHistory","goodsOffOnConfirm","that","requestProductOperate","productOperate","productIds","onsale","goods","setTimeout","requestDelete","productRemove","path","query","putStrHistory","saveHistory","requestData","productSearch","nmd","initHistory","mounted","component","isRedundantNavigation","err","indexOf","route","router","config","to","url","replace","promise","location","href","functionalRoute","context","parent","$router","props","routeProps","String","Boolean","Object"],"sourceRoot":""}