"use strict";(self["webpackChunkflower_shop"]=self["webpackChunkflower_shop"]||[]).push([[415],{1590:function(t,e,n){n.d(e,{Z:function(){return l}});var i=function(){var t=this,e=t._self._c;return e("div",[t._t("topSlot"),e("div",[e("div",{staticClass:"goods-item-main"},[e("div",{staticClass:"goods-item-img"},[t._t("imgSlot")],2),e("div",{staticClass:"goods-item-content"},[e("div",{staticClass:"goods-item-title"},[t._t("nameSlot")],2),e("div",{staticClass:"goods-item-attribute"},[t._t("attributeSlot")],2)])])]),t._t("menuSlot")],2)},o=[],s={name:"goodsItem",data(){return{}},methods:{},mounted(){}},a=s,r=n(1001),c=(0,r.Z)(a,i,o,!1,null,"1f769a80",null),l=c.exports},9093:function(t,e,n){n.d(e,{Z:function(){return d}});var i=function(){var t=this,e=t._self._c;return e("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[e("van-picker",{ref:"picker",attrs:{title:"标题","show-toolbar":"",columns:t.columns,"value-key":t.valueKey},on:{confirm:t.onConfirm,cancel:t.onCancel}})],1)},o=[],s=(n(1958),n(2939),n(1744),n(7722)),a=(n(836),n(6811)),r={name:"pickerPopup",components:{[a.Z.name]:a.Z,[s.Z.name]:s.Z},data(){return{show:!1,columns:[]}},props:{datas:{type:Array,default:()=>[]},valueKey:{type:String,default:"text"}},methods:{setList(t){this.columns=t},showPopup(t){this.show=!this.show,t&&this.$nextTick((e=>{this.$refs.picker.setIndexes(t)}))},onConfirm(t,e){this.show=!1,this.$emit("confirm",t,e)},onCancel(){this.show=!1}},mounted(){},watch:{datas(){this.datas.length>0&&(this.columns=this.datas)}}},c=r,l=n(1001),u=(0,l.Z)(c,i,o,!1,null,"7de9f24c",null),d=u.exports},9332:function(t,e,n){n.r(e),n.d(e,{default:function(){return g}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"root"},[e("action-bar",{attrs:{title:"修改商品价格、库存"}}),t.goodsList.length>1?e("div",{staticClass:"batch-price"},[e("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.check,callback:function(e){t.check=e},expression:"check"}},[e("van-radio",{attrs:{name:"up","checked-color":"#0e932e","icon-size":"16px"}},[t._v("批量加价")]),e("van-radio",{attrs:{name:"down","checked-color":"#0e932e","icon-size":"16px"}},[t._v("批量降价")])],1),e("div",{staticClass:"batch-money"},[e("span",[t._v("¥")]),e("div",{staticClass:"batch-input-box"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.batchPrice,expression:"batchPrice"}],staticClass:"batch-input",attrs:{type:"number"},domProps:{value:t.batchPrice},on:{input:function(e){e.target.composing||(t.batchPrice=e.target.value)}}})]),e("span",[t._v("元")]),e("div",{staticClass:"batch-sure",on:{click:t.bindBatchSure}},[t._v("确定")])])],1):t._e(),e("div",{staticClass:"container"},[e("scroll-view",{staticClass:"content",attrs:{data:t.goodsList}},t._l(t.goodsList,(function(i,o){return e("goods-item",{key:i.productId},[e("van-image",{staticClass:"goods-img",attrs:{slot:"imgSlot",radius:".25rem",src:t.baseUrl+i.imageUrl},slot:"imgSlot"}),e("div",{staticClass:"goods-title",attrs:{slot:"nameSlot"},slot:"nameSlot"},[t._v(t._s(i.productName))]),e("div",{attrs:{slot:"attributeSlot"},slot:"attributeSlot"},[e("div",{staticClass:"attribute"},[e("div",{staticClass:"attribute-content"},[t._v("颜色："+t._s(i.color))]),e("div",{staticClass:"attribute-content"},[t._v("规格："+t._s(i.unit))]),e("div",{staticClass:"attribute-content"},[t._v("等级："+t._s(i.level))])]),e("div",{staticClass:"attribute"},[e("div",{staticClass:"attribute-content"},[t._v("可售库存："+t._s(i.stock))]),e("div",{staticClass:"attribute-content"},[t._v("下单冻结："+t._s(i.stockFreeze))])])]),e("div",{staticClass:"goods-bottom",attrs:{slot:"menuSlot"},slot:"menuSlot"},[e("div",{staticClass:"price-stock"},[e("div",[t._v("价格：")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i.priceStay,expression:"item.priceStay"}],staticClass:"input-bg margin-right",attrs:{maxlength:"10",type:"number",placeholder:i.price},domProps:{value:i.priceStay},on:{input:function(e){e.target.composing||t.$set(i,"priceStay",e.target.value)}}})]),e("div",{staticClass:"price-stock"},[t._v(" 总库存："),e("input",{directives:[{name:"model",rawName:"v-model",value:i.stockStay,expression:"item.stockStay"}],staticClass:"input-bg",attrs:{type:"number",placeholder:i.stockTotal,maxlength:"10"},domProps:{value:i.stockStay},on:{input:function(e){e.target.composing||t.$set(i,"stockStay",e.target.value)}}})]),e("div",{staticClass:"price-stock",on:{click:function(e){return t.showStockPopup(o,i.reasonIndex)}}},[e("div",{class:["price-stock-content",void 0==i.reasonIndex||0==i.reasonIndex?"empty":""]},[t._v(" "+t._s(void 0==i.reasonIndex||0==i.reasonIndex?"修改库存原因":t.reasonList[i.reasonIndex].text)+" "),e("img",{staticClass:"empty-img",attrs:{src:n(3442)}})])])])],1)})),1)],1),e("div",{staticClass:"bottom"},[e("div",{staticClass:"button-normal",on:{click:t.handleSubmit}},[t._v("提交")])]),e("picker-popup",{ref:"stockPopup",on:{confirm:t.choiceStockType}})],1)},o=[],s=(n(4889),n(5705)),a=(n(7396),n(8253)),r=(n(1e3),n(6338)),c=(n(7658),n(1590)),l=n(5928),u=n(9093),d={name:"updatePriceStock",components:{goodsItem:c.Z,pickerPopup:u.Z,[r.Z.name]:r.Z,[a.Z.name]:a.Z,[s.Z.name]:s.Z.Component},data(){return{goodsData:[],goodsList:[],check:"",batchPrice:"",reasonList:[{id:0,text:"无"},{id:3,text:"报销库存"},{id:4,text:"遗失库存"},{id:5,text:"线下售卖"}],stockIndex:0}},methods:{choiceStockType(t,e){const n=this.goodsList[this.stockIndex];n.stockType=t.id,n.reasonIndex=e,this.$forceUpdate()},bindBatchSure(){const t=this.check;if(!t)return void this.$toast("请选择批量加价或降价");const e=this.batchPrice;if(!e)return void this.$toast("请输入金额");let n=0;"up"===t?n+=parseFloat(e):n-=parseFloat(e);const i=this.goodsList;let o="";for(let s=0;s<i.length;s++){const t=i[s];let e="";e=void 0!==t.priceStay?parseFloat(t.priceStay)+n:parseFloat(t.price)+n,e>=0?t.priceStay=e:o=o+t.productName+"\n"}o&&s.Z.alert({title:"降价成功，以下商品降价后价格低于0元",message:o}).then((()=>{})),this.goodsList=i;let a="";a="up"===t?"加价成功，请提交生效":"降价成功，请提交生效",this.$toast(a),this.$forceUpdate()},showStockPopup(t,e){this.stockIndex=t;const n=e||0;this.$refs.stockPopup.showPopup([n]),this.$forceUpdate()},handleSubmit(){const t=this.goodsList;if(0===t.length)return;for(const n of t)if(!n.priceStay&&!n.stockStay)return void this.$toast("<"+n.productName+">价格或库存必须填写一项");const e=[];t.forEach((t=>{e.push({productId:t.productId,price:t.priceStay?t.priceStay:t.price,stock:t.stockStay?t.stockStay:t.stockTotal,stockType:""!==t.stockType?t.stockType:0})})),(0,l.jI)({data:JSON.stringify(e)}).then((t=>{const e=this.goodsData,n=this.goodsList;for(let i=0;i<e.length;i++){const t=e[i],o=n[i];t.price=o.priceStay?o.priceStay:o.price,t.stock=o.stockStay?o.stockStay:o.stock}this.$route.params.goodsData=e,this.$router.go(-1),this.$toast.success("修改成功")})).catch((t=>{this.$toast(t.msg)}))}},mounted(){this.goodsData=this.$route.query.data;let t="";const e=this.goodsData;for(let n=0;n<e.length;n++)t+=e[n].productId,n<e.length-1&&(t+=",");(0,l.HH)({productIds:t}).then((t=>{this.goodsList=t.data.result})).catch((t=>{this.$toast(t.msg)})),this.$refs.stockPopup.setList(this.reasonList)}},h=d,p=n(1001),f=(0,p.Z)(h,i,o,!1,null,"1d9200c6",null),g=f.exports},1452:function(){},4398:function(t,e,n){n(7658);var i=n(9299),o=n(3915),s=n.n(o),a=n(855),r=n(4771),c=n(1047),l=n(2250),u=n(9858),d=n(4958),h=(0,a.d)("button"),p=h[0],f=h[1];function g(t,e,n,i){var o,a=e.tag,h=e.icon,p=e.type,g=e.color,m=e.plain,v=e.disabled,b=e.loading,k=e.hairline,y=e.loadingText,C=e.iconPosition,S={};function x(t){e.loading&&t.preventDefault(),b||v||((0,r.j8)(i,"click",t),(0,l.fz)(i))}function B(t){(0,r.j8)(i,"touchstart",t)}g&&(S.color=m?g:"white",m||(S.background=g),-1!==g.indexOf("gradient")?S.border=0:S.borderColor=g);var A=[f([p,e.size,{plain:m,loading:b,disabled:v,hairline:k,block:e.block,round:e.round,square:e.square}]),(o={},o[c._K]=k,o)];function w(){return b?n.loading?n.loading():t(d.Z,{class:f("loading"),attrs:{size:e.loadingSize,type:e.loadingType,color:"currentColor"}}):n.icon?t("div",{class:f("icon")},[n.icon()]):h?t(u.Z,{attrs:{name:h,classPrefix:e.iconPrefix},class:f("icon")}):void 0}function $(){var i,o=[];return"left"===C&&o.push(w()),i=b?y:n.default?n.default():e.text,i&&o.push(t("span",{class:f("text")},[i])),"right"===C&&o.push(w()),o}return t(a,s()([{style:S,class:A,attrs:{type:e.nativeType,disabled:v},on:{click:x,touchstart:B}},(0,r.ED)(i)]),[t("div",{class:f("content")},[$()])])}g.props=(0,i.Z)({},l.g2,{text:String,icon:String,color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:String,loadingText:String,loadingType:String,tag:{type:String,default:"button"},type:{type:String,default:"default"},size:{type:String,default:"normal"},loadingSize:{type:String,default:"20px"},iconPosition:{type:String,default:"left"}}),e["Z"]=p(g)},5705:function(t,e,n){n.d(e,{Z:function(){return D}});var i,o=n(9299),s=n(6369),a=n(3915),r=n.n(a),c=n(855),l=n(3370),u=n(408),d=n(1047),h=n(7846),p=n(4398),f=n(9435),g=(0,c.d)("goods-action"),m=g[0],v=g[1],b=m({mixins:[(0,f.G)("vanGoodsAction")],props:{safeAreaInsetBottom:{type:Boolean,default:!0}},render:function(){var t=arguments[0];return t("div",{class:v({unfit:!this.safeAreaInsetBottom})},[this.slots()])}}),k=n(2250),y=(0,c.d)("goods-action-button"),C=y[0],S=y[1],x=C({mixins:[(0,f.j)("vanGoodsAction")],props:(0,o.Z)({},k.g2,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean}),computed:{isFirst:function(){var t=this.parent&&this.parent.children[this.index-1];return!t||t.$options.name!==this.$options.name},isLast:function(){var t=this.parent&&this.parent.children[this.index+1];return!t||t.$options.name!==this.$options.name}},methods:{onClick:function(t){this.$emit("click",t),(0,k.BC)(this.$router,this)}},render:function(){var t=arguments[0];return t(p.Z,{class:S([{first:this.isFirst,last:this.isLast},this.type]),attrs:{size:"large",type:this.type,icon:this.icon,color:this.color,loading:this.loading,disabled:this.disabled},on:{click:this.onClick}},[this.slots()||this.text])}}),B=(0,c.d)("dialog"),A=B[0],w=B[1],$=B[2],P=A({mixins:[(0,h.e)()],props:{title:String,theme:String,width:[Number,String],message:String,className:null,callback:Function,beforeClose:Function,messageAlign:String,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showCancelButton:Boolean,overlay:{type:Boolean,default:!0},allowHtml:{type:Boolean,default:!0},transition:{type:String,default:"van-dialog-bounce"},showConfirmButton:{type:Boolean,default:!0},closeOnPopstate:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!1}},data:function(){return{loading:{confirm:!1,cancel:!1}}},methods:{onClickOverlay:function(){this.handleAction("overlay")},handleAction:function(t){var e=this;this.$emit(t),this.value&&(this.beforeClose?(this.loading[t]=!0,this.beforeClose(t,(function(n){!1!==n&&e.loading[t]&&e.onClose(t),e.loading.confirm=!1,e.loading.cancel=!1}))):this.onClose(t))},onClose:function(t){this.close(),this.callback&&this.callback(t)},onOpened:function(){var t=this;this.$emit("opened"),this.$nextTick((function(){var e;null==(e=t.$refs.dialog)||e.focus()}))},onClosed:function(){this.$emit("closed")},onKeydown:function(t){var e=this;if("Escape"===t.key||"Enter"===t.key){if(t.target!==this.$refs.dialog)return;var n={Enter:this.showConfirmButton?function(){return e.handleAction("confirm")}:l.ZT,Escape:this.showCancelButton?function(){return e.handleAction("cancel")}:l.ZT};n[t.key](),this.$emit("keydown",t)}},genRoundButtons:function(){var t=this,e=this.$createElement;return e(b,{class:w("footer")},[this.showCancelButton&&e(x,{attrs:{size:"large",type:"warning",text:this.cancelButtonText||$("cancel"),color:this.cancelButtonColor,loading:this.loading.cancel},class:w("cancel"),on:{click:function(){t.handleAction("cancel")}}}),this.showConfirmButton&&e(x,{attrs:{size:"large",type:"danger",text:this.confirmButtonText||$("confirm"),color:this.confirmButtonColor,loading:this.loading.confirm},class:w("confirm"),on:{click:function(){t.handleAction("confirm")}}})])},genButtons:function(){var t,e=this,n=this.$createElement,i=this.showCancelButton&&this.showConfirmButton;return n("div",{class:[d.k7,w("footer")]},[this.showCancelButton&&n(p.Z,{attrs:{size:"large",loading:this.loading.cancel,text:this.cancelButtonText||$("cancel"),nativeType:"button"},class:w("cancel"),style:{color:this.cancelButtonColor},on:{click:function(){e.handleAction("cancel")}}}),this.showConfirmButton&&n(p.Z,{attrs:{size:"large",loading:this.loading.confirm,text:this.confirmButtonText||$("confirm"),nativeType:"button"},class:[w("confirm"),(t={},t[d.a8]=i,t)],style:{color:this.confirmButtonColor},on:{click:function(){e.handleAction("confirm")}}})])},genContent:function(t,e){var n=this.$createElement;if(e)return n("div",{class:w("content")},[e]);var i=this.message,o=this.messageAlign;if(i){var s,a,c={class:w("message",(s={"has-title":t},s[o]=o,s)),domProps:(a={},a[this.allowHtml?"innerHTML":"textContent"]=i,a)};return n("div",{class:w("content",{isolated:!t})},[n("div",r()([{},c]))])}}},render:function(){var t=arguments[0];if(this.shouldRender){var e=this.message,n=this.slots(),i=this.slots("title")||this.title,o=i&&t("div",{class:w("header",{isolated:!e&&!n})},[i]);return t("transition",{attrs:{name:this.transition},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[t("div",{directives:[{name:"show",value:this.value}],attrs:{role:"dialog","aria-labelledby":this.title||e,tabIndex:0},class:[w([this.theme]),this.className],style:{width:(0,u.N)(this.width)},ref:"dialog",on:{keydown:this.onKeydown}},[o,this.genContent(i,n),"round-button"===this.theme?this.genRoundButtons():this.genButtons()])])}}});function Z(t){return document.body.contains(t)}function _(){i&&i.$destroy(),i=new(s.ZP.extend(P))({el:document.createElement("div"),propsData:{lazyRender:!1}}),i.$on("input",(function(t){i.value=t}))}function T(t){return l.sk?Promise.resolve():new Promise((function(e,n){i&&Z(i.$el)||_(),(0,o.Z)(i,T.currentOptions,t,{resolve:e,reject:n})}))}T.defaultOptions={value:!0,title:"",width:"",theme:null,message:"",overlay:!0,className:"",allowHtml:!0,lockScroll:!0,transition:"van-dialog-bounce",beforeClose:null,overlayClass:"",overlayStyle:null,messageAlign:"",getContainer:"body",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1,callback:function(t){i["confirm"===t?"resolve":"reject"](t)}},T.alert=T,T.confirm=function(t){return T((0,o.Z)({showCancelButton:!0},t))},T.close=function(){i&&(i.value=!1)},T.setDefaultOptions=function(t){(0,o.Z)(T.currentOptions,t)},T.resetDefaultOptions=function(){T.currentOptions=(0,o.Z)({},T.defaultOptions)},T.resetDefaultOptions(),T.install=function(){s.ZP.use(P)},T.Component=P,s.ZP.prototype.$dialog=T;var D=T},4889:function(t,e,n){n(1958),n(6196),n(3332),n(6742),n(2666),n(2939),n(1452)},5423:function(t,e,n){n.d(e,{p:function(){return r}});n(541),n(7658);var i=n(9858),o=n(5065),s=n(9435),a=n(408),r=function(t){var e=t.parent,n=t.bem,r=t.role;return{mixins:[(0,s.j)(e),o.f],props:{name:null,value:null,disabled:Boolean,iconSize:[Number,String],checkedColor:String,labelPosition:String,labelDisabled:Boolean,shape:{type:String,default:"round"},bindGroup:{type:Boolean,default:!0}},computed:{disableBindRelation:function(){return!this.bindGroup},isDisabled:function(){return this.parent&&this.parent.disabled||this.disabled},direction:function(){return this.parent&&this.parent.direction||null},iconStyle:function(){var t=this.checkedColor||this.parent&&this.parent.checkedColor;if(t&&this.checked&&!this.isDisabled)return{borderColor:t,backgroundColor:t}},tabindex:function(){return this.isDisabled||"radio"===r&&!this.checked?-1:0}},methods:{onClick:function(t){var e=this,n=t.target,i=this.$refs.icon,o=i===n||(null==i?void 0:i.contains(n));this.isDisabled||!o&&this.labelDisabled?this.$emit("click",t):(this.toggle(),setTimeout((function(){e.$emit("click",t)})))},genIcon:function(){var t=this.$createElement,e=this.checked,o=this.iconSize||this.parent&&this.parent.iconSize;return t("div",{ref:"icon",class:n("icon",[this.shape,{disabled:this.isDisabled,checked:e}]),style:{fontSize:(0,a.N)(o)}},[this.slots("icon",{checked:e})||t(i.Z,{attrs:{name:"success"},style:this.iconStyle})])},genLabel:function(){var t=this.$createElement,e=this.slots();if(e)return t("span",{class:n("label",[this.labelPosition,{disabled:this.isDisabled}])},[e])}},render:function(){var t=arguments[0],e=[this.genIcon()];return"left"===this.labelPosition?e.unshift(this.genLabel()):e.push(this.genLabel()),t("div",{attrs:{role:r,tabindex:this.tabindex,"aria-checked":String(this.checked)},class:n([{disabled:this.isDisabled,"label-disabled":this.labelDisabled},this.direction]),on:{click:this.onClick}},[e])}}}},5065:function(t,e,n){n.d(e,{f:function(){return i}});var i={inject:{vanField:{default:null}},watch:{value:function(){var t=this.vanField;t&&(t.resetValidation(),t.validateWithTrigger("onChange"))}},created:function(){var t=this.vanField;t&&!t.children&&(t.children=this)}}},6338:function(t,e,n){var i=n(855),o=n(5065),s=n(9435),a=(0,i.d)("radio-group"),r=a[0],c=a[1];e["Z"]=r({mixins:[(0,s.G)("vanRadio"),o.f],props:{value:null,disabled:Boolean,direction:String,checkedColor:String,iconSize:[Number,String]},watch:{value:function(t){this.$emit("change",t)}},render:function(){var t=arguments[0];return t("div",{class:c([this.direction]),attrs:{role:"radiogroup"}},[this.slots()])}})},1e3:function(t,e,n){n(1958)},8253:function(t,e,n){var i=n(855),o=n(5423),s=(0,i.d)("radio"),a=s[0],r=s[1];e["Z"]=a({mixins:[(0,o.p)({bem:r,role:"radio",parent:"vanRadio"})],computed:{currentValue:{get:function(){return this.parent?this.parent.value:this.value},set:function(t){(this.parent||this).$emit("input",t)}},checked:function(){return this.currentValue===this.name}},methods:{toggle:function(){this.currentValue=this.name}}})},7396:function(t,e,n){n(1958),n(3332),n(6742)},2250:function(t,e,n){function i(t){return"NavigationDuplicated"===t.name||t.message&&-1!==t.message.indexOf("redundant navigation")}function o(t,e){var n=e.to,o=e.url,s=e.replace;if(n&&t){var a=t[s?"replace":"push"](n);a&&a.catch&&a.catch((function(t){if(t&&!i(t))throw t}))}else o&&(s?location.replace(o):location.href=o)}function s(t){o(t.parent&&t.parent.$router,t.props)}n.d(e,{BC:function(){return o},fz:function(){return s},g2:function(){return a}});var a={url:String,replace:Boolean,to:[String,Object]}},3442:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAARBAMAAABOcrPPAAAAElBMVEUAAAB4kJx4kJx4kJx4kJx4kJw9RttBAAAABXRSTlMAgOtwYOgIl2UAAABQSURBVBjTTcrRCcAwCEVRu4E/maDtAh2hG6Tg/qsUkgtXQX3oiTej1XHFPfthfDEqG6i5WlDJEDAFLAFbQPBB6oAogAAkAAlAApBsYD0n4QfAVhEBu85bzwAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=415.bf17f236.js.map